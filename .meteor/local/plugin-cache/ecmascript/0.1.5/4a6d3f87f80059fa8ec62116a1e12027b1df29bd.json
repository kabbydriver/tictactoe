{"metadata":{"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}},"usedHelpers":[]},"ignored":false,"code":"var Table = new Mongo.Collection(\"table\");\nvar Counter = new Mongo.Collection(\"counter\");\nvar Turn = new Mongo.Collection(\"turn\");\n\nif (Meteor.isClient) {\n  // counter starts at 0\n  Session.setDefault('counter', 0);\n\n  Template.board.helpers({\n    rows: function () {\n      return Table.find({});\n    }\n  });\n\n  Template.row.helpers({\n    columns: function (parentContext) {\n      return this.cols;\n    }\n  });\n\n  Template.row.events({\n    'click td': function (event, template) {\n      var row = Table.findOne(template.data._id);\n      var cols = row.cols;\n\n      var mark = cols[this.col - 1].playerMark;\n      var turn = Turn.findOne({});\n\n      if (mark != 0 || turn.playerTurn != Session.get('player')) {\n        return;\n      }\n\n      cols[this.col - 1].playerMark = Session.get('player');\n      var next = Session.get('player') == 1 ? 2 : 1;\n      Table.update(template.data._id, { $set: { cols: cols } });\n      Turn.update(turn._id, { $set: { playerTurn: next } });\n\n      //create board\n      var board = [];\n      var row1 = new Array(3);\n      var row2 = new Array(3);\n      var row3 = new Array(3);\n      board.push(row1);\n      board.push(row2);\n      board.push(row3);\n      var data = Table.find().fetch();\n      Table.find().forEach(function (doc) {\n        var row = doc.row - 1;\n        for (var col in babelHelpers.sanitizeForInObject(doc.cols)) {\n          board[row][col] = doc.cols[col].playerMark;\n        }\n      });\n    }\n  });\n\n  Template.cell.helpers({\n    getImage: function () {\n      if (this.playerMark == 0) {\n        return '';\n      } else if (this.playerMark == 1) {\n        return 'X';\n      } else {\n        return 'O';\n      }\n    }\n  });\n\n  Template.reset.events({\n    'click button': function () {\n      var countDoc = Counter.findOne({});\n      Table.find({}).forEach(function (doc) {\n        var cols = doc.cols;\n        cols.forEach(function (cell) {\n          cell.playerMark = 0;\n          Table.update(doc._id, { $set: { cols: cols } });\n        });\n      });\n      Turn.find({}).forEach(function (doc) {\n        Turn.update(doc._id, { $set: { playerTurn: 1 } });\n      });\n    }\n  });\n\n  Template.gameStatus.helpers({\n    whoseTurn: function () {\n      var turn = Turn.findOne().playerTurn;\n      var player = Session.get('player');\n      var winner = Session.get('winner');\n      if (winner) {\n        return \"Player \" + winner + \"won!\";\n      }\n\n      if (turn === player) {\n        return \"Your Move\";\n      } else {\n        return \"Waiting for Player \" + turn;\n      }\n    }\n  });\n\n  Template.registerHelper('getPlayer', function () {\n    return Session.get('player');\n  });\n}\n\nif (Meteor.isServer) {\n  Meteor.startup(function () {\n    // code to run on server at startup\n  });\n}\n\nFlowRouter.route('/player1', {\n  action: function () {\n    Session.set('player', 1);\n  }\n});\n\nFlowRouter.route('/player2', {\n  action: function () {\n    Session.set('player', 2);\n  }\n});","ast":null,"map":{"version":3,"sources":["/tictactoe.js"],"names":[],"mappings":"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","file":"/tictactoe.js.map","sourcesContent":["var Table = new Mongo.Collection(\"table\");\nvar Counter = new Mongo.Collection(\"counter\");\nvar Turn = new Mongo.Collection(\"turn\");\n\nif (Meteor.isClient) {\n  // counter starts at 0\n  Session.setDefault('counter', 0);\n\n\n  Template.board.helpers({\n  \trows: function() {\n  \t\treturn Table.find({});\t\t\t\n  \t}\n  });\n\n  Template.row.helpers({\n  \tcolumns: function(parentContext) {\n  \t\treturn this.cols;\n  \t}\n  });\n\n  Template.row.events({\n  \t'click td': function(event, template) {\n  \t\tvar row = Table.findOne(template.data._id);\n  \t\tvar cols = row.cols\n\n  \t\tvar mark = cols[this.col-1].playerMark;\n  \t\tvar turn = Turn.findOne({});\n\n  \t\tif (mark != 0 || turn.playerTurn != Session.get('player')) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tcols[this.col-1].playerMark = Session.get('player');\n  \t\tvar next = (Session.get('player') == 1) ? 2 : 1;\n  \t\tTable.update(template.data._id, {$set: {cols: cols}});\n  \t\tTurn.update(turn._id, {$set: {playerTurn: next}});\n\n\n  \t\t//create board\n  \t\tvar board = [];\n  \t\tvar row1 = new Array(3);\n  \t\tvar row2 = new Array(3);\n  \t\tvar row3 = new Array(3);\n  \t\tboard.push(row1);\n  \t\tboard.push(row2);\n  \t\tboard.push(row3);\n  \t\tvar data = Table.find().fetch();\n  \t\tTable.find().forEach(function(doc){\n  \t\t\tvar row = doc.row - 1;\n  \t\t\tfor (var col in doc.cols) {\n  \t\t\t\tboard[row][col] = doc.cols[col].playerMark\n  \t\t\t}\n  \t\t});\n\n  \t}\n  });\n\n  Template.cell.helpers({\n  \tgetImage: function() {\n  \t\tif (this.playerMark == 0) {\n  \t\t\treturn '';\n  \t\t} else if (this.playerMark == 1) {\n  \t\t\treturn 'X';\n  \t\t} else {\n  \t\t\treturn 'O';\n  \t\t}\n  \t}\n  });\n\n  Template.reset.events({\n  \t'click button': function() {\n  \t\tvar countDoc = Counter.findOne({});\n  \t\tTable.find({}).forEach(function (doc) {\n  \t\t\tvar cols = doc.cols\n  \t\t\tcols.forEach(function(cell) {\n  \t\t\t\tcell.playerMark = 0;\n  \t\t\t\tTable.update(doc._id, {$set: {cols: cols}});\n  \t\t\t});\n  \t\t});\n  \t\tTurn.find({}).forEach(function(doc) { \n  \t\t\tTurn.update(doc._id, {$set: {playerTurn: 1}});\n  \t\t})\n  \t}\n  });\n\n  Template.gameStatus.helpers({\n  \twhoseTurn: function() {\n  \t\tvar turn = Turn.findOne().playerTurn;\n  \t\tvar player = Session.get('player');\n  \t\tvar winner = Session.get('winner');\n  \t\tif (winner) {\n  \t\t\treturn \"Player \" + winner + \"won!\";\n  \t\t}\n\n  \t\tif (turn === player) {\n  \t\t\treturn \"Your Move\";\n  \t\t} else {\n  \t\t\treturn \"Waiting for Player \" + turn;\n  \t\t}\n\n  \t}\n  });\n\n  Template.registerHelper('getPlayer', function(){\n  \treturn Session.get('player');\n  });\n\n}\n\nif (Meteor.isServer) {\n\tMeteor.startup(function () {\n    // code to run on server at startup\n\t});\n}\n\nFlowRouter.route('/player1', { \n  action: function() { \n    Session.set('player', 1); \n  } \n}); \n \nFlowRouter.route('/player2', { \n  action: function() { \n    Session.set('player', 2); \n  } \n}); \n"]},"hash":"4a6d3f87f80059fa8ec62116a1e12027b1df29bd"}
